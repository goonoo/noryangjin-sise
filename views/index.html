<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>노량진 수산시장 시세</title>
</head>
<body>
  <div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>

  <script src="/j/jquery-1.8.3.min.js"></script>
  <script src="/highcharts/js/highcharts.js"></script>
  <script src="/highcharts/js/modules/exporting.js"></script>

<% if (count > 0) { %>
  <script>
  $(function () {
    var chart;
    $(document).ready(function() {
      chart = new Highcharts.Chart({
        chart: {
          renderTo: 'container',
          type: 'line',
          marginRight: 130,
          marginBottom: 25
        },
        title: {
          text: '노량진 수산시장 시세',
          x: -20 //center
        },
        subtitle: {
          text: 'Source: www.susansijang.co.kr',
          x: -20
        },
        xAxis: {
          categories: [
            <% for (var i=1; i<=days; i++) { %>
              "<%= month %>/<%= i %>"<%= i<days ? ',' : '' %>
            <% } %>
          ]
        },
        yAxis: {
          title: {
            text: '원'
          },
          plotLines: [{
            value: 0,
            width: 1,
            color: '#808080'
          }]
        },
        tooltip: {
          formatter: function() {
            return '<b>'+ this.series.name +'</b><br/>'+
            this.x +': '+ this.y +'원';
          }
        },
        legend: {
          layout: 'vertical',
          align: 'right',
          verticalAlign: 'top',
          x: -10,
          y: 100,
          borderWidth: 0
        },
        series: [
          <% for (var i=0, l=fishes.length; i<l; i++) { %>
          {
            name: '<%= fishes[i].alias %>',
            connectNulls: true,
            data: [
              <% for (var j=1; j<=days; j++) { %>
                <%= fishes[i].prices[''+ ym +
                    (j < 10 ? '0'+ j : j)] || 'null' %><%= j<days ? ',' : '' %>
              <% } %>
            ]
          }<%= i+1<l ? ',' : '' %>
          <% } %>
        ]
      });
    });
  });
  </script>
<% } %>
</body>
</html>
